[build-system]
requires = [
    "scikit-build-core>=0.11",
    "pybind11>=2.13",
    "numpy>=2.0",
]
build-backend = "scikit_build_core.build"

[project]
name = "simcoon"
dynamic = ["version"]
description = "Simulation in Mechanics and Materials: Interactive Tools - A library for the simulation of multiphysics systems and heterogeneous materials"
readme = "README.md"
license = {text = "GPL-3.0-or-later"}
authors = [
    { name = "Yves Chemisky", email = "yves.chemisky@gmail.com" },
]
maintainers = [
    { name = "Yves Chemisky", email = "yves.chemisky@gmail.com" },
]
requires-python = ">=3.10"
dependencies = [
    "numpy>=2.0",
]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Science/Research",
    "Intended Audience :: Developers",
    "Operating System :: OS Independent",
    "Programming Language :: C++",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Scientific/Engineering",
    "Topic :: Scientific/Engineering :: Physics",
    "Topic :: Scientific/Engineering :: Mathematics",
]
keywords = [
    "simulation",
    "mechanics",
    "materials",
    "composites",
    "homogenization",
    "constitutive-models",
    "finite-element",
    "micromechanics",
]

[project.urls]
Homepage = "https://github.com/3MAH/simcoon"
Documentation = "https://3mah.github.io/simcoon-docs/"
Repository = "https://github.com/3MAH/simcoon.git"
Issues = "https://github.com/3MAH/simcoon/issues"
Changelog = "https://github.com/3MAH/simcoon/releases"

[project.optional-dependencies]
dev = [
    "pytest>=7.0",
]

# =============================================================================
# scikit-build-core configuration
# =============================================================================

[tool.scikit-build]
minimum-version = "build-system.requires"
build-dir = "build/{wheel_tag}"
logging.level = "INFO"

# Editable install settings for development
editable.mode = "redirect"
editable.rebuild = true
editable.verbose = true

# Metadata: extract version from __version__.py
metadata.version.provider = "scikit_build_core.metadata.regex"
metadata.version.input = "python-setup/simcoon/__version__.py"

# CMake configuration
cmake.version = ">=3.15"
cmake.build-type = "Release"

# Wheel configuration - include Python files from python-setup/simcoon
wheel.packages = ["python-setup/simcoon"]
wheel.install-dir = "simcoon"

# Only install targets with COMPONENT python (skip dylib, headers, cmake files)
install.components = ["python"]

[tool.scikit-build.cmake.define]
SIMCOON_BUILD_TESTS = "OFF"

# =============================================================================
# pytest configuration
# =============================================================================

[tool.pytest.ini_options]
testpaths = ["simcoon-python-builder/test"]
python_files = ["test_*.py", "*_test.py", "run_test.py"]
addopts = "-v --tb=short"


